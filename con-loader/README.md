[![license: MIT/Apache-2.0](https://img.shields.io/badge/license-MIT%2FApache--2.0-blue.svg)](LICENSE-MIT)
[![crates.io](https://img.shields.io/crates/v/con-loader.svg)](https://crates.io/crates/con-loader)
[![docs.rs](https://docs.rs/con-loader/badge.svg)](https://docs.rs/con-loader)

# con-loader

`con-loader` provides supporting code for the `con` crate, handling module building and loading on MacOS and Linux. End users shouldn't need to use this crate directly - it exists as a dependency of the `con` crate and crates generated by the [con-cli](https://crates.io/crates/con-cli) tool.

However, this is the right place to learn about environment variables that will impact the
behavior of con-loader at runtime:

* `CON_TARGET_DIR`: Set the build directory for hot-reloadable plugins. By default, plugins are built into `$HOME/.con-mods/{mod-name}` or `%USERPROFILE%\.con-mods\{mod-name}` on Windows.

* `CON_BUILD`: Set to "0" to disable automatic mod compilation. Defaults to "1".

* `CON_NOISY_BUILDS`: Set to "1" to pipe build output directly to stdout/stderr. By default, output is only shown if the build fails.

In production, you probably want `CON_AUTOMATIC_MOD_BUILD` to be set to zero, as your mods
should be pre-built, and put in the right place, next to the executable.

That is, if your Cargo workspace looks like this:

```
workspace/
  Cargo.toml
  mods/
    mod-markdown/
    mod-clap/
    con-markdown/
    con-clap/
  app/
    Cargo.toml
    src/lib.rs etc.
```

Then `con-loader` expects a file hierarchy like this:

```
workspace/
  target/
    debug/
      app
      libmod_markdown.dylib
      libmod_clap.dylib
```

Except it doesn't actually need to be in `target/debug/` of anywhere â€” this could all be
in a container image under `/app` or whatever.
